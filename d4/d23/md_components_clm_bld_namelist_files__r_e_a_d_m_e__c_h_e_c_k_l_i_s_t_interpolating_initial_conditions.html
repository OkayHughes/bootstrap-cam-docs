<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CAM6: Steps for interpolating out-of-the-box initial conditions</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CAM6
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Steps for interpolating out-of-the-box initial conditions </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>These are the steps that should be taken when interpolating (via <code>init_interp</code>) out-of-the-box initial conditions files. This is often done so that we'll have out-of-the-box initial conditions files that are compatible with the current memory allocation, etc. (thus not requiring <code>init_interp</code> to be run all the time).</p>
<p>Do the following for each initial conditions file you want to interpolate:</p>
<ol type="1">
<li>From the latest master tag, create and run a test using the appropriate compset and resolution for this initial conditions file. Note that there may be other options (like carbon isotopes) that also need to be turned on. While doing this, generate baselines. e.g., run <code>SMS_Ld1.f09_g17.I1850Clm50Sp.cheyenne_intel.clm-default</code> or <code>SMS_Ld1.f09_g17.I1850Clm50BgcCrop.cheyenne_intel.clm-ciso</code>, with baseline generation.<ul>
<li>Confirm that the test points to the desired, original finidat file, and that <code>use_init_interp</code> is .true. by default.</li>
</ul>
</li>
<li>Rename the <code>finidat_interp_dest.nc</code> file that was generated by this test, giving it a name that matches the original initial conditions file, but with a new date stamp. Move this file into place (<code>$CESMDATAROOT/inputdata/lnd/clm2/initdata_map/</code>).</li>
<li><p class="startli">Add global metadata to the new file, mentioning the original file, the test used to generate this new file, the tag used to run this test, and a summary of what is different on this new version. For example:</p>
<div class="fragment"><div class="line">ncatted -h -a Notes_190111,global,c,c,&#39;Interpolated from clmi.I1850Clm50BgcCrop.1366-01-01.0.9x1.25_gx1v6_simyr1850_c171213.nc. This is the finidat_interp_dest.nc file from SMS_Ln1.f09_g17.I1850Clm50BgcCrop.cheyenne_intel, run from ctsm1.0.dev022. Updates from the previous file are: (1) uses gx1v7 rather than gx1v6; (2) many inactive points are absent.&#39;</div>
</div><!-- fragment --></li>
<li>Using <code>ncdump -h</code>, diff the headers of the new and old files, and make sure that there are no unexpected differences. Especially look for missing fields on the new file, which could indicate, for example, that carbon isotopes were turned on in the original run but not in your new run.</li>
<li>Update <code>namelist_defaults_ctsm.xml</code> to point to the new file.<ul>
<li>Be sure to change any attributes in both the <code>finidat</code> entry and the <code>init_interp_attributes</code> entry for this file. In particular, if the old file had the attribute <code>use_init_interp=".true."</code>, this should now be removed.</li>
</ul>
</li>
<li>Rerun the one-day test for which you generated baselines, comparing against these baselines. Check the following:<ul>
<li><code>use_init_interp</code> should be .false.</li>
<li>The test should use the new <code>finidat</code> file</li>
<li>The test should pass and be bit-for-bit with the baseline </li>
</ul>
</li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
