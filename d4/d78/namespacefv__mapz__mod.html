<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CAM6: fv_mapz_mod Module Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CAM6
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">fv_mapz_mod Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The module '<a class="el" href="../../d9/dfb/namespacefv__mapz.html">fv_mapz</a>' contains the vertical mapping routines <b>[lin2004vertically]</b>.  
<a href="../../d4/d78/namespacefv__mapz__mod.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a0c56cad3566b5d03032b2c251925ad86"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#a0c56cad3566b5d03032b2c251925ad86">lagrangian_to_eulerian</a> (last_step, consv, ps, pe, delp, pkz, pk, mdt, pdt, km, is, ie, js, je, isd, ied, jsd, jed, nq, nwat, sphum, q_con, u, v, w, delz, pt, q, hs, r_vir, cp, akap, cappa, kord_mt, kord_wz, kord_tr, kord_tm, peln, te0_2d, ng, ua, va, omga, te, ws, fill, reproduce_sum, out_dt, dtdt, ptop, ak, bk, pfull, gridstruct, domain, do_sat_adj, hydrostatic, hybrid_z, do_omega, adiabatic, do_adiabatic_init)</td></tr>
<tr class="memdesc:a0c56cad3566b5d03032b2c251925ad86"><td class="mdescLeft">&#160;</td><td class="mdescRight">The subroutine 'Lagrangian_to_Eulerian' remaps deformed Lagrangian layers back to the reference Eulerian coordinate.  <br /></td></tr>
<tr class="separator:a0c56cad3566b5d03032b2c251925ad86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a88277aeaf10321b9ba0d0fbeaef1d9"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#a9a88277aeaf10321b9ba0d0fbeaef1d9">compute_total_energy</a> (is, ie, js, je, isd, ied, jsd, jed, km, u, v, w, delz, pt, delp, q, qc, pe, peln, hs, rsin2_l, cosa_s_l, r_vir, cp, rg, hlv, te_2d, ua, va, teq, moist_phys, nwat, sphum, liq_wat, rainwat, ice_wat, snowwat, graupel, hydrostatic, id_te)</td></tr>
<tr class="memdesc:a9a88277aeaf10321b9ba0d0fbeaef1d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The subroutine 'compute_total_energy' performs the FV3-consistent computation of the global total energy.  <br /></td></tr>
<tr class="separator:a9a88277aeaf10321b9ba0d0fbeaef1d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add39354bb1bcbdf4b51fb093c045e8c1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#add39354bb1bcbdf4b51fb093c045e8c1">rst_remap</a> (km, kn, is, ie, js, je, isd, ied, jsd, jed, nq, ntp, delp_r, u_r, v_r, w_r, delz_r, pt_r, q_r, qdiag_r, delp, u, v, w, delz, pt, q, qdiag, ak_r, bk_r, ptop, ak, bk, hydrostatic, make_nh, domain, square_domain)</td></tr>
<tr class="memdesc:add39354bb1bcbdf4b51fb093c045e8c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The subroutine 'rst_remap' remaps all variables required for a restart.  <br /></td></tr>
<tr class="separator:add39354bb1bcbdf4b51fb093c045e8c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8ee4094f27d3aa103d9101c1a46a5cd"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#ab8ee4094f27d3aa103d9101c1a46a5cd">mappm</a> (km, pe1, q1, kn, pe2, q2, i1, i2, iv, kord, ptop)</td></tr>
<tr class="memdesc:ab8ee4094f27d3aa103d9101c1a46a5cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">The subroutine 'mappm' is a general-purpose routine for remapping one set of vertical levels to another.  <br /></td></tr>
<tr class="separator:ab8ee4094f27d3aa103d9101c1a46a5cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e2f210d41b616b0d7fb31e6f624897c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#a7e2f210d41b616b0d7fb31e6f624897c">moist_cv</a> (is, ie, isd, ied, jsd, jed, km, j, k, nwat, sphum, liq_wat, rainwat, ice_wat, snowwat, graupel, q, qd, cvm, t1)</td></tr>
<tr class="memdesc:a7e2f210d41b616b0d7fb31e6f624897c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The subroutine 'moist_cv' computes the FV3-consistent moist heat capacity under constant volume, including the heating capacity of water vapor and condensates.  <br /></td></tr>
<tr class="separator:a7e2f210d41b616b0d7fb31e6f624897c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae179a4a6af972dd3480b55f62c1ce72e"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#ae179a4a6af972dd3480b55f62c1ce72e">moist_cp</a> (is, ie, isd, ied, jsd, jed, km, j, k, nwat, sphum, liq_wat, rainwat, ice_wat, snowwat, graupel, q, qd, cpm, t1)</td></tr>
<tr class="memdesc:ae179a4a6af972dd3480b55f62c1ce72e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The subroutine 'moist_cp' computes the FV3-consistent moist heat capacity under constant pressure, including the heating capacity of water vapor and condensates.  <br /></td></tr>
<tr class="separator:ae179a4a6af972dd3480b55f62c1ce72e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7879730f4b2baa275cd6abaf9c369bb5"><td class="memItemLeft" align="right" valign="top">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#a7879730f4b2baa275cd6abaf9c369bb5">consv_min</a> = 0.001</td></tr>
<tr class="memdesc:a7879730f4b2baa275cd6abaf9c369bb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">below which no correction applies  <br /></td></tr>
<tr class="separator:a7879730f4b2baa275cd6abaf9c369bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cf7f37723bbfb2e7d6b4d948ea81567"><td class="memItemLeft" align="right" valign="top">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#a7cf7f37723bbfb2e7d6b4d948ea81567">t_min</a> = 184.</td></tr>
<tr class="memdesc:a7cf7f37723bbfb2e7d6b4d948ea81567"><td class="mdescLeft">&#160;</td><td class="mdescRight">below which applies stricter constraint  <br /></td></tr>
<tr class="separator:a7cf7f37723bbfb2e7d6b4d948ea81567"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85ad5e9000a3d762fd9a62ce59fa9213"><td class="memItemLeft" align="right" valign="top">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#a85ad5e9000a3d762fd9a62ce59fa9213">r3</a> = 1./3.</td></tr>
<tr class="separator:a85ad5e9000a3d762fd9a62ce59fa9213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24b67f915ffc43180f28b980d9ca7d4c"><td class="memItemLeft" align="right" valign="top">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#a24b67f915ffc43180f28b980d9ca7d4c">r23</a> = 2./3.</td></tr>
<tr class="separator:a24b67f915ffc43180f28b980d9ca7d4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb8dc5fd25041ba11e452a3994360336"><td class="memItemLeft" align="right" valign="top">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#abb8dc5fd25041ba11e452a3994360336">r12</a> = 1./12.</td></tr>
<tr class="separator:abb8dc5fd25041ba11e452a3994360336"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c1b41c250d4fae86c8297ebe5f71577"><td class="memItemLeft" align="right" valign="top">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#a4c1b41c250d4fae86c8297ebe5f71577">cv_vap</a> = 3.*rvgas</td></tr>
<tr class="memdesc:a4c1b41c250d4fae86c8297ebe5f71577"><td class="mdescLeft">&#160;</td><td class="mdescRight">1384.5  <br /></td></tr>
<tr class="separator:a4c1b41c250d4fae86c8297ebe5f71577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac280285d39826f98f83043a75f01d44e"><td class="memItemLeft" align="right" valign="top">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#ac280285d39826f98f83043a75f01d44e">cv_air</a> = cp_air - rdgas</td></tr>
<tr class="memdesc:ac280285d39826f98f83043a75f01d44e"><td class="mdescLeft">&#160;</td><td class="mdescRight">= rdgas * (7/2-1) = 2.5*rdgas=717.68  <br /></td></tr>
<tr class="separator:ac280285d39826f98f83043a75f01d44e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa58d5b9a96c7678b42b9f21dae04d56"><td class="memItemLeft" align="right" valign="top">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#aaa58d5b9a96c7678b42b9f21dae04d56">c_ice</a> = 1972.</td></tr>
<tr class="memdesc:aaa58d5b9a96c7678b42b9f21dae04d56"><td class="mdescLeft">&#160;</td><td class="mdescRight">heat capacity of ice at -15.C  <br /></td></tr>
<tr class="separator:aaa58d5b9a96c7678b42b9f21dae04d56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e5a6070f8657332c3dc64bd06f62bc"><td class="memItemLeft" align="right" valign="top">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#aa0e5a6070f8657332c3dc64bd06f62bc">c_liq</a> = 4.1855e+3</td></tr>
<tr class="memdesc:aa0e5a6070f8657332c3dc64bd06f62bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">GFS: heat capacity of water at 0C.  <br /></td></tr>
<tr class="separator:aa0e5a6070f8657332c3dc64bd06f62bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa9aa99fd17c4042bf8dab0df746acc"><td class="memItemLeft" align="right" valign="top">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#aefa9aa99fd17c4042bf8dab0df746acc">cp_vap</a> = cp_vapor</td></tr>
<tr class="memdesc:aefa9aa99fd17c4042bf8dab0df746acc"><td class="mdescLeft">&#160;</td><td class="mdescRight">1846.  <br /></td></tr>
<tr class="separator:aefa9aa99fd17c4042bf8dab0df746acc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79c88aa388441e010f8532f6802b3240"><td class="memItemLeft" align="right" valign="top">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#a79c88aa388441e010f8532f6802b3240">tice</a> = 273.16</td></tr>
<tr class="separator:a79c88aa388441e010f8532f6802b3240"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f144b640540ec10df24f75e367c2057"><td class="memItemLeft" align="right" valign="top">real(kind=4), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d78/namespacefv__mapz__mod.html#a5f144b640540ec10df24f75e367c2057">e_flux</a> = 0.</td></tr>
<tr class="separator:a5f144b640540ec10df24f75e367c2057"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The module '<a class="el" href="../../d9/dfb/namespacefv__mapz.html">fv_mapz</a>' contains the vertical mapping routines <b>[lin2004vertically]</b>. </p>
<dl class="section note"><dt>Note</dt><dd>April 12, 2012 -SJL: This revision may actually produce rounding level differences due to the elimination of KS to compute pressure level for remapping. </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a9a88277aeaf10321b9ba0d0fbeaef1d9" name="a9a88277aeaf10321b9ba0d0fbeaef1d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a88277aeaf10321b9ba0d0fbeaef1d9">&#9670;&#160;</a></span>compute_total_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fv_mapz_mod::compute_total_energy </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>js</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>je</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>isd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,  jsd:jed+1,km), intent(inout)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied+1,jsd:jed,  km), intent(inout)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:,jsd:,1:), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:,jsd:,1:), intent(in)&#160;</td>
          <td class="paramname"><em>delz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km), intent(in)&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km), intent(in)&#160;</td>
          <td class="paramname"><em>delp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km,*), intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km), intent(in)&#160;</td>
          <td class="paramname"><em>qc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is-1:ie+1,km+1,js-1:je+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,km+1,js:je), intent(in)&#160;</td>
          <td class="paramname"><em>peln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed), intent(in)&#160;</td>
          <td class="paramname"><em>hs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied, jsd:jed), intent(in)&#160;</td>
          <td class="paramname"><em>rsin2_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied, jsd:jed), intent(in)&#160;</td>
          <td class="paramname"><em>cosa_s_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>r_vir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>rg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>hlv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,js:je), intent(out)&#160;</td>
          <td class="paramname"><em>te_2d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km), intent(inout)&#160;</td>
          <td class="paramname"><em>ua</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km), intent(inout)&#160;</td>
          <td class="paramname"><em>va</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,js:je), intent(out)&#160;</td>
          <td class="paramname"><em>teq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>moist_phys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sphum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>liq_wat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>rainwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ice_wat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>snowwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>graupel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>hydrostatic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>id_te</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The subroutine 'compute_total_energy' performs the FV3-consistent computation of the global total energy. </p>
<p>It includes the potential, internal (latent and sensible heat), kinetic terms. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>vertical velocity (m/s) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hs</td><td>surface geopotential </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pe</td><td>pressure at layer edges </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">peln</td><td>log(pe) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">te_2d</td><td>vertically integrated TE </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">teq</td><td>Moist TE Local </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="https://drive.google.com/uc?id=1rhUvkO4ImBPnTC6c_YbUVIb5Lao-cO5K" border="0" usemap="#ad4/d78/namespacefv__mapz__mod_a9a88277aeaf10321b9ba0d0fbeaef1d9_cgraph" alt=""/></div>
<map name="ad4/d78/namespacefv__mapz__mod_a9a88277aeaf10321b9ba0d0fbeaef1d9_cgraph" id="ad4/d78/namespacefv__mapz__mod_a9a88277aeaf10321b9ba0d0fbeaef1d9_cgraph">
<area shape="rect" title="The subroutine &#39;compute_total_energy&#39; performs the FV3&#45;consistent computation of the global total ene..." alt="" coords="5,23,168,63"/>
<area shape="rect" href="../../d4/da3/namespacefv__fill__mod.html#a41d77a13ceec78e4ea68f5e5266c9458" title="The subroutine &#39;fillz&#39; is for mass&#45;conservative filling of nonphysical negative values in the tracers..." alt="" coords="242,5,355,31"/>
<area shape="rect" href="../../d4/d78/namespacefv__mapz__mod.html#a7e2f210d41b616b0d7fb31e6f624897c" title="The subroutine &#39;moist_cv&#39; computes the FV3&#45;consistent moist heat capacity under constant volume,..." alt="" coords="216,55,381,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="https://drive.google.com/uc?id=1rhIruKlmhnQwFwmM1vC-XoNmdTetPMAU" border="0" usemap="#ad4/d78/namespacefv__mapz__mod_a9a88277aeaf10321b9ba0d0fbeaef1d9_icgraph" alt=""/></div>
<map name="ad4/d78/namespacefv__mapz__mod_a9a88277aeaf10321b9ba0d0fbeaef1d9_icgraph" id="ad4/d78/namespacefv__mapz__mod_a9a88277aeaf10321b9ba0d0fbeaef1d9_icgraph">
<area shape="rect" title="The subroutine &#39;compute_total_energy&#39; performs the FV3&#45;consistent computation of the global total ene..." alt="" coords="447,69,609,109"/>
<area shape="rect" href="../../db/d8c/namespacefv__dynamics__mod.html#a57030300ce6aacf81a3588faf906f07f" title=" " alt="" coords="252,69,399,109"/>
<area shape="rect" href="../../d5/df8/namespaceatmosphere__mod.html#a9dff78295a0b7ca403fc4b66adecfe96" title="The subroutine &#39;atmosphere_dynamics&#39; is an API for the main driver of the FV3 dynamical core responsi..." alt="" coords="5,5,204,45"/>
<area shape="rect" href="../../d5/df8/namespaceatmosphere__mod.html#a44ef1921c91b506dfc907a51e58e8e76" title="The subroutine &#39;atmospehre_state_update&#39; is an API to apply tendencies and compute a consistent progn..." alt="" coords="5,69,204,109"/>
<area shape="rect" href="../../d2/d1b/namespacedyn__comp.html#a27e8a98048bd96e53b2568ddd10e322c" title=" " alt="" coords="37,134,173,159"/>
</map>
</div>

</div>
</div>
<a id="a0c56cad3566b5d03032b2c251925ad86" name="a0c56cad3566b5d03032b2c251925ad86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c56cad3566b5d03032b2c251925ad86">&#9670;&#160;</a></span>lagrangian_to_eulerian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fv_mapz_mod::lagrangian_to_eulerian </td>
          <td>(</td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>last_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>consv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed), intent(inout)&#160;</td>
          <td class="paramname"><em>ps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is-1:ie+1,km+1,js-1:je+1), intent(inout)&#160;</td>
          <td class="paramname"><em>pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km), intent(inout)&#160;</td>
          <td class="paramname"><em>delp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,js:je,km), intent(out)&#160;</td>
          <td class="paramname"><em>pkz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,js:je,km+1), intent(inout)&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>mdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>pdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>js</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>je</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>isd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sphum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:,jsd:,1:), intent(inout)&#160;</td>
          <td class="paramname"><em>q_con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied  ,jsd:jed+1,km), intent(inout)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied+1,jsd:jed  ,km), intent(inout)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:     ,jsd:     ,1:), intent(inout)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:,jsd:,1:), intent(inout)&#160;</td>
          <td class="paramname"><em>delz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied  ,jsd:jed  ,km), intent(inout)&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km,*), intent(inout)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed), intent(in)&#160;</td>
          <td class="paramname"><em>hs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>r_vir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>akap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:,jsd:,1:), intent(inout)&#160;</td>
          <td class="paramname"><em>cappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord_mt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord_wz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(nq), intent(in)&#160;</td>
          <td class="paramname"><em>kord_tr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord_tm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,km+1,js:je), intent(inout)&#160;</td>
          <td class="paramname"><em>peln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,js:je), intent(inout)&#160;</td>
          <td class="paramname"><em>te0_2d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km), intent(inout)&#160;</td>
          <td class="paramname"><em>ua</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km), intent(inout)&#160;</td>
          <td class="paramname"><em>va</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km), intent(inout)&#160;</td>
          <td class="paramname"><em>omga</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km), intent(out)&#160;</td>
          <td class="paramname"><em>te</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,js:je), intent(in)&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fill</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>reproduce_sum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>out_dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,js:je,km), intent(inout)&#160;</td>
          <td class="paramname"><em>dtdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ptop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(km+1), intent(in)&#160;</td>
          <td class="paramname"><em>ak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(km+1), intent(in)&#160;</td>
          <td class="paramname"><em>bk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(km), intent(in)&#160;</td>
          <td class="paramname"><em>pfull</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="../../df/de0/structfv__arrays__mod_1_1fv__grid__type.html">fv_grid_type</a>), intent(in), target&#160;</td>
          <td class="paramname"><em>gridstruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="../../d6/df3/structmpp__domains__mod_1_1domain2d.html">domain2d</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>do_sat_adj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>hydrostatic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>hybrid_z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>do_omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>adiabatic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>do_adiabatic_init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The subroutine 'Lagrangian_to_Eulerian' remaps deformed Lagrangian layers back to the reference Eulerian coordinate. </p>
<p>It also includes the entry point for calling fast microphysical processes. This is typically calle on the k_split loop. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mdt</td><td>remap time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pdt</td><td>phys time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nq</td><td>number of tracers (including h2o) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sphum</td><td>index for water vapor (specific humidity) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ied</td><td>starting &amp; ending X-Dir index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jed</td><td>starting &amp; ending Y-Dir index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kord_mt</td><td>Mapping order for the vector winds </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kord_wz</td><td>Mapping order/option for w </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kord_tr</td><td>Mapping order for tracers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kord_tm</td><td>Mapping order for thermodynamics </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">consv</td><td>factor for TE conservation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hs</td><td>surface geopotential </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fill</td><td>fill negative tracers </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pk</td><td>pe to the kappa </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">delp</td><td>pressure thickness </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pe</td><td>pressure at layer edges </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ps</td><td>surface pressure </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">u</td><td>u-wind (m/s) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">v</td><td>v-wind (m/s) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">w</td><td>vertical velocity (m/s) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pt</td><td>cp*virtual potential temperature as input; output: temperature </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ua</td><td>u-wind (m/s) on physics grid </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">va</td><td>v-wind (m/s) on physics grid </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">omga</td><td>vertical press. velocity (pascal/sec) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">peln</td><td>log(pe) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pkz</td><td>layer-mean pk for converting t to pt </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="https://drive.google.com/uc?id=1rmOc01vMfUTYMpxQj0GKJYrIxbxCoqAx" border="0" usemap="#ad4/d78/namespacefv__mapz__mod_a0c56cad3566b5d03032b2c251925ad86_cgraph" alt=""/></div>
<map name="ad4/d78/namespacefv__mapz__mod_a0c56cad3566b5d03032b2c251925ad86_cgraph" id="ad4/d78/namespacefv__mapz__mod_a0c56cad3566b5d03032b2c251925ad86_cgraph">
<area shape="rect" title="The subroutine &#39;Lagrangian_to_Eulerian&#39; remaps deformed Lagrangian layers back to the reference Euler..." alt="" coords="5,158,176,198"/>
<area shape="rect" href="../../d4/da3/namespacefv__fill__mod.html#a41d77a13ceec78e4ea68f5e5266c9458" title="The subroutine &#39;fillz&#39; is for mass&#45;conservative filling of nonphysical negative values in the tracers..." alt="" coords="250,5,363,31"/>
<area shape="rect" href="../../d2/de9/namespacefv__cmp__mod.html#a91dbcebcbf1050297451c1db6db38371" title="The subroutine &#39;fv_sat_adj&#39; performs the fast processes in the GFDL microphysics." alt="" coords="224,55,389,80"/>
<area shape="rect" href="../../dc/dcd/namespacefv__grid__utils__mod.html#acf53e76b1bc9e689efe4900919cd05ef" title="The function &#39;g_sum&#39; is the fast version of &#39;globalsum&#39;." alt="" coords="241,129,373,169"/>
<area shape="rect" href="../../d4/d78/namespacefv__mapz__mod.html#a7e2f210d41b616b0d7fb31e6f624897c" title="The subroutine &#39;moist_cv&#39; computes the FV3&#45;consistent moist heat capacity under constant volume,..." alt="" coords="224,193,389,219"/>
<area shape="rect" href="../../df/d8b/pkez_8_f90.html#ac03305dc1b65367afd9f4185f7e9bebd" title=" " alt="" coords="281,243,332,268"/>
<area shape="rect" href="../../d2/de9/namespacefv__cmp__mod.html#a5ce7347205d43a859b0316a584642f4d" title="The subroutine &#39;qs_init&#39; initializes lookup tables for the saturation mixing ratio." alt="" coords="235,292,378,317"/>
<area shape="rect" href="../../d3/d04/edyn__mudcom_8_f90.html#a79b0b9da86b999126e41115b18612a1d" title=" " alt="" coords="437,55,477,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="https://drive.google.com/uc?id=1rjVriabbdA1aC9Fe49_uUka57NVb_-ds" border="0" usemap="#ad4/d78/namespacefv__mapz__mod_a0c56cad3566b5d03032b2c251925ad86_icgraph" alt=""/></div>
<map name="ad4/d78/namespacefv__mapz__mod_a0c56cad3566b5d03032b2c251925ad86_icgraph" id="ad4/d78/namespacefv__mapz__mod_a0c56cad3566b5d03032b2c251925ad86_icgraph">
<area shape="rect" title="The subroutine &#39;Lagrangian_to_Eulerian&#39; remaps deformed Lagrangian layers back to the reference Euler..." alt="" coords="447,69,617,109"/>
<area shape="rect" href="../../db/d8c/namespacefv__dynamics__mod.html#a57030300ce6aacf81a3588faf906f07f" title=" " alt="" coords="252,69,399,109"/>
<area shape="rect" href="../../d5/df8/namespaceatmosphere__mod.html#a9dff78295a0b7ca403fc4b66adecfe96" title="The subroutine &#39;atmosphere_dynamics&#39; is an API for the main driver of the FV3 dynamical core responsi..." alt="" coords="5,5,204,45"/>
<area shape="rect" href="../../d5/df8/namespaceatmosphere__mod.html#a44ef1921c91b506dfc907a51e58e8e76" title="The subroutine &#39;atmospehre_state_update&#39; is an API to apply tendencies and compute a consistent progn..." alt="" coords="5,69,204,109"/>
<area shape="rect" href="../../d2/d1b/namespacedyn__comp.html#a27e8a98048bd96e53b2568ddd10e322c" title=" " alt="" coords="37,134,173,159"/>
</map>
</div>

</div>
</div>
<a id="ab8ee4094f27d3aa103d9101c1a46a5cd" name="ab8ee4094f27d3aa103d9101c1a46a5cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8ee4094f27d3aa103d9101c1a46a5cd">&#9670;&#160;</a></span>mappm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fv_mapz_mod::mappm </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(i1:i2,km+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(i1:i2,km), intent(in)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(i1:i2,kn+1), intent(in)&#160;</td>
          <td class="paramname"><em>pe2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(i1:i2,kn), intent(out)&#160;</td>
          <td class="paramname"><em>q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ptop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The subroutine 'mappm' is a general-purpose routine for remapping one set of vertical levels to another. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pe2</td><td>pe1: pressure at layer edges from model top to bottom surface in the ORIGINAL vertical coordinate pe2: pressure at layer edges from model top to bottom surface in the NEW vertical coordinate </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="https://drive.google.com/uc?id=1sdL7Tg0m6TWvLghq0fGWatxszOTsy6lx" border="0" usemap="#ad4/d78/namespacefv__mapz__mod_ab8ee4094f27d3aa103d9101c1a46a5cd_icgraph" alt=""/></div>
<map name="ad4/d78/namespacefv__mapz__mod_ab8ee4094f27d3aa103d9101c1a46a5cd_icgraph" id="ad4/d78/namespacefv__mapz__mod_ab8ee4094f27d3aa103d9101c1a46a5cd_icgraph">
<area shape="rect" title="The subroutine &#39;mappm&#39; is a general&#45;purpose routine for remapping one set of vertical levels to anoth..." alt="" coords="741,77,896,102"/>
<area shape="rect" href="../../d3/d92/external__ic_8_f90.html#a50b389b209a18f6c37b98e7357ac1388" title=" " alt="" coords="47,13,186,38"/>
<area shape="rect" href="../../d8/d3a/fv__nudge_8_f90.html#ae934e0b7b518be107f4b7a8982e3f9e7" title=" " alt="" coords="544,48,672,73"/>
<area shape="rect" href="../../dc/dd9/namespacefv__regional__mod.html#a5d96a3344dcf720b5f9b66300038fd32" title=" " alt="" coords="523,98,693,138"/>
<area shape="rect" href="../../d1/dbf/namespacefv__nesting__mod.html#a2612d1e314613aa7b0ccd422320bd5dc" title="The subroutine&#39;twoway_nesting&#39; performs a two&#45;way update of nested&#45;grid data onto the parent grid." alt="" coords="525,219,691,259"/>
<area shape="rect" href="../../dc/dd9/namespacefv__regional__mod.html#a06dd274d9d27de8153eaa939480f46a1" title=" " alt="" coords="300,162,451,202"/>
<area shape="rect" href="../../dc/dd9/namespacefv__regional__mod.html#a9236fd23c2f6f94334a58db641164af2" title=" " alt="" coords="300,34,451,74"/>
<area shape="rect" href="../../dc/dd9/namespacefv__regional__mod.html#a4d805f9d65b50e02f107d850dca6ed83" title=" " alt="" coords="300,98,451,138"/>
<area shape="rect" href="../../d5/df8/namespaceatmosphere__mod.html#a9dff78295a0b7ca403fc4b66adecfe96" title="The subroutine &#39;atmosphere_dynamics&#39; is an API for the main driver of the FV3 dynamical core responsi..." alt="" coords="17,190,216,230"/>
<area shape="rect" href="../../d5/df8/namespaceatmosphere__mod.html#ab5992283c17a8edcd779207f37a9a1a4" title="The subroutine &#39;atmosphere_init&#39; is an API to initialize the FV3 dynamical core, including the grid s..." alt="" coords="5,105,228,130"/>
<area shape="rect" href="../../d5/df8/namespaceatmosphere__mod.html#a44ef1921c91b506dfc907a51e58e8e76" title="The subroutine &#39;atmospehre_state_update&#39; is an API to apply tendencies and compute a consistent progn..." alt="" coords="276,276,475,316"/>
</map>
</div>

</div>
</div>
<a id="ae179a4a6af972dd3480b55f62c1ce72e" name="ae179a4a6af972dd3480b55f62c1ce72e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae179a4a6af972dd3480b55f62c1ce72e">&#9670;&#160;</a></span>moist_cp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fv_mapz_mod::moist_cp </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>isd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sphum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>liq_wat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>rainwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ice_wat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>snowwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>graupel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km,nwat), intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie), intent(out)&#160;</td>
          <td class="paramname"><em>qd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie), intent(out)&#160;</td>
          <td class="paramname"><em>cpm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie), intent(in), optional&#160;</td>
          <td class="paramname"><em>t1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The subroutine 'moist_cp' computes the FV3-consistent moist heat capacity under constant pressure, including the heating capacity of water vapor and condensates. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="https://drive.google.com/uc?id=1sQNYkOdjlYauxFHtvhTWEpyJfftqIvnK" border="0" usemap="#ad4/d78/namespacefv__mapz__mod_ae179a4a6af972dd3480b55f62c1ce72e_icgraph" alt=""/></div>
<map name="ad4/d78/namespacefv__mapz__mod_ae179a4a6af972dd3480b55f62c1ce72e_icgraph" id="ad4/d78/namespacefv__mapz__mod_ae179a4a6af972dd3480b55f62c1ce72e_icgraph">
<area shape="rect" title="The subroutine &#39;moist_cp&#39; computes the FV3&#45;consistent moist heat capacity under constant pressure,..." alt="" coords="447,99,612,125"/>
<area shape="rect" href="../../db/d8c/namespacefv__dynamics__mod.html#a57030300ce6aacf81a3588faf906f07f" title=" " alt="" coords="252,60,399,100"/>
<area shape="rect" href="../../d5/d0a/namespacefv__update__phys__mod.html#a20b8b5e5c1eb35110859d33036dbb4c0" title=" " alt="" coords="252,124,399,164"/>
<area shape="rect" href="../../d5/df8/namespaceatmosphere__mod.html#a9dff78295a0b7ca403fc4b66adecfe96" title="The subroutine &#39;atmosphere_dynamics&#39; is an API for the main driver of the FV3 dynamical core responsi..." alt="" coords="5,5,204,45"/>
<area shape="rect" href="../../d5/df8/namespaceatmosphere__mod.html#a44ef1921c91b506dfc907a51e58e8e76" title="The subroutine &#39;atmospehre_state_update&#39; is an API to apply tendencies and compute a consistent progn..." alt="" coords="5,121,204,161"/>
<area shape="rect" href="../../d2/d1b/namespacedyn__comp.html#a27e8a98048bd96e53b2568ddd10e322c" title=" " alt="" coords="37,70,173,95"/>
</map>
</div>

</div>
</div>
<a id="a7e2f210d41b616b0d7fb31e6f624897c" name="a7e2f210d41b616b0d7fb31e6f624897c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e2f210d41b616b0d7fb31e6f624897c">&#9670;&#160;</a></span>moist_cv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fv_mapz_mod::moist_cv </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>isd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sphum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>liq_wat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>rainwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ice_wat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>snowwat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>graupel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,km,nwat), intent(in)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie), intent(out)&#160;</td>
          <td class="paramname"><em>qd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie), intent(out)&#160;</td>
          <td class="paramname"><em>cvm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie), intent(in), optional&#160;</td>
          <td class="paramname"><em>t1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The subroutine 'moist_cv' computes the FV3-consistent moist heat capacity under constant volume, including the heating capacity of water vapor and condensates. </p>
<p>See <b>[emanuel1994atmospheric]</b> for information on variable heat capacities. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="https://drive.google.com/uc?id=1riEuYdLp9-4CGpNRiZ75NVBo5nHdz8Lg" border="0" usemap="#ad4/d78/namespacefv__mapz__mod_a7e2f210d41b616b0d7fb31e6f624897c_icgraph" alt=""/></div>
<map name="ad4/d78/namespacefv__mapz__mod_a7e2f210d41b616b0d7fb31e6f624897c_icgraph" id="ad4/d78/namespacefv__mapz__mod_a7e2f210d41b616b0d7fb31e6f624897c_icgraph">
<area shape="rect" title="The subroutine &#39;moist_cv&#39; computes the FV3&#45;consistent moist heat capacity under constant volume,..." alt="" coords="665,99,831,125"/>
<area shape="rect" href="../../d4/d78/namespacefv__mapz__mod.html#a9a88277aeaf10321b9ba0d0fbeaef1d9" title="The subroutine &#39;compute_total_energy&#39; performs the FV3&#45;consistent computation of the global total ene..." alt="" coords="451,5,613,45"/>
<area shape="rect" href="../../db/d8c/namespacefv__dynamics__mod.html#a57030300ce6aacf81a3588faf906f07f" title=" " alt="" coords="252,76,399,116"/>
<area shape="rect" href="../../d5/d0a/namespacefv__update__phys__mod.html#a20b8b5e5c1eb35110859d33036dbb4c0" title=" " alt="" coords="252,152,399,192"/>
<area shape="rect" href="../../d4/d78/namespacefv__mapz__mod.html#a0c56cad3566b5d03032b2c251925ad86" title="The subroutine &#39;Lagrangian_to_Eulerian&#39; remaps deformed Lagrangian layers back to the reference Euler..." alt="" coords="447,120,617,160"/>
<area shape="rect" href="../../d5/df8/namespaceatmosphere__mod.html#a9dff78295a0b7ca403fc4b66adecfe96" title="The subroutine &#39;atmosphere_dynamics&#39; is an API for the main driver of the FV3 dynamical core responsi..." alt="" coords="5,33,204,73"/>
<area shape="rect" href="../../d5/df8/namespaceatmosphere__mod.html#a44ef1921c91b506dfc907a51e58e8e76" title="The subroutine &#39;atmospehre_state_update&#39; is an API to apply tendencies and compute a consistent progn..." alt="" coords="5,149,204,189"/>
<area shape="rect" href="../../d2/d1b/namespacedyn__comp.html#a27e8a98048bd96e53b2568ddd10e322c" title=" " alt="" coords="37,98,173,123"/>
</map>
</div>

</div>
</div>
<a id="add39354bb1bcbdf4b51fb093c045e8c1" name="add39354bb1bcbdf4b51fb093c045e8c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add39354bb1bcbdf4b51fb093c045e8c1">&#9670;&#160;</a></span>rst_remap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fv_mapz_mod::rst_remap </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>js</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>je</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>isd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ntp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,js:je,km), intent(in)&#160;</td>
          <td class="paramname"><em>delp_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,  js:je+1,km), intent(in)&#160;</td>
          <td class="paramname"><em>u_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie+1,js:je  ,km), intent(in)&#160;</td>
          <td class="paramname"><em>v_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,js:je,km), intent(in)&#160;</td>
          <td class="paramname"><em>w_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,js:je,km), intent(inout)&#160;</td>
          <td class="paramname"><em>delz_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,js:je,km), intent(inout)&#160;</td>
          <td class="paramname"><em>pt_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,js:je,km,1:ntp), intent(in)&#160;</td>
          <td class="paramname"><em>q_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(is:ie,js:je,km,ntp+1:nq), intent(in)&#160;</td>
          <td class="paramname"><em>qdiag_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,kn), intent(out)&#160;</td>
          <td class="paramname"><em>delp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied  ,jsd:jed+1,kn), intent(out)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied+1,jsd:jed  ,kn), intent(out)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:     ,jsd:     ,1:), intent(out)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:,jsd:,1:), intent(out)&#160;</td>
          <td class="paramname"><em>delz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied  ,jsd:jed  ,kn), intent(out)&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,kn,1:ntp), intent(out)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(isd:ied,jsd:jed,kn,ntp+1:nq), intent(out)&#160;</td>
          <td class="paramname"><em>qdiag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(km+1), intent(in)&#160;</td>
          <td class="paramname"><em>ak_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(km+1), intent(in)&#160;</td>
          <td class="paramname"><em>bk_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ptop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(kn+1), intent(in)&#160;</td>
          <td class="paramname"><em>ak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, <a class="el" href="../../d9/d4a/mpp__update__nest__domains_8h.html#a26822f45fa1167a47dacf14152ba0e3c">dimension</a>(kn+1), intent(in)&#160;</td>
          <td class="paramname"><em>bk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>hydrostatic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>make_nh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="../../d6/df3/structmpp__domains__mod_1_1domain2d.html">domain2d</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>square_domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The subroutine 'rst_remap' remaps all variables required for a restart. </p>
<p>npz_restart /= npz (i.e., when the number of vertical levels is changed at restart) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>Restart z-dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kn</td><td>Run time dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntp</td><td>Number of tracers (including H2O) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ied</td><td>Starting &amp; ending X-Dir index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jed</td><td>Starting &amp; ending Y-Dir index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delp_r</td><td>Pressure thickness </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u_r</td><td>u-wind (m/s) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v_r</td><td>v-wind (m/s) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">delp</td><td>Pressure thickness </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">u</td><td>u-wind (m/s) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">v</td><td>v-wind (m/s) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">w</td><td>Vertical velocity (m/s) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pt</td><td>Temperature </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">delz</td><td>Delta-height (m) </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="https://drive.google.com/uc?id=1sY3-09Hy6SWWV4_ksMoBjoDY3EW-ZQna" border="0" usemap="#ad4/d78/namespacefv__mapz__mod_add39354bb1bcbdf4b51fb093c045e8c1_icgraph" alt=""/></div>
<map name="ad4/d78/namespacefv__mapz__mod_add39354bb1bcbdf4b51fb093c045e8c1_icgraph" id="ad4/d78/namespacefv__mapz__mod_add39354bb1bcbdf4b51fb093c045e8c1_icgraph">
<area shape="rect" title="The subroutine &#39;rst_remap&#39; remaps all variables required for a restart." alt="" coords="671,13,841,38"/>
<area shape="rect" href="../../d8/d73/namespacefv__io__mod.html#a7dd3caf037e1893118959b48dd7a96ab" title="The subroutine &#39;remap_restart&#39; remaps the model state from remap files to a new set of Eulerian coord..." alt="" coords="452,13,623,38"/>
<area shape="rect" href="../../d1/d20/namespacefv__restart__mod.html#a6f6f077869048d667327767ba7d80177" title="The subroutine &#39;fv_restart&#39; initializes the model state, including prognaostic variables and several ..." alt="" coords="276,5,404,45"/>
<area shape="rect" href="../../d5/df8/namespaceatmosphere__mod.html#ab5992283c17a8edcd779207f37a9a1a4" title="The subroutine &#39;atmosphere_init&#39; is an API to initialize the FV3 dynamical core, including the grid s..." alt="" coords="5,13,228,38"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aaa58d5b9a96c7678b42b9f21dae04d56" name="aaa58d5b9a96c7678b42b9f21dae04d56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa58d5b9a96c7678b42b9f21dae04d56">&#9670;&#160;</a></span>c_ice</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a> fv_mapz_mod::c_ice = 1972.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>heat capacity of ice at -15.C </p>

</div>
</div>
<a id="aa0e5a6070f8657332c3dc64bd06f62bc" name="aa0e5a6070f8657332c3dc64bd06f62bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0e5a6070f8657332c3dc64bd06f62bc">&#9670;&#160;</a></span>c_liq</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a> fv_mapz_mod::c_liq = 4.1855e+3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GFS: heat capacity of water at 0C. </p>

</div>
</div>
<a id="a7879730f4b2baa275cd6abaf9c369bb5" name="a7879730f4b2baa275cd6abaf9c369bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7879730f4b2baa275cd6abaf9c369bb5">&#9670;&#160;</a></span>consv_min</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a> fv_mapz_mod::consv_min = 0.001</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>below which no correction applies </p>

</div>
</div>
<a id="aefa9aa99fd17c4042bf8dab0df746acc" name="aefa9aa99fd17c4042bf8dab0df746acc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefa9aa99fd17c4042bf8dab0df746acc">&#9670;&#160;</a></span>cp_vap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a> fv_mapz_mod::cp_vap = cp_vapor</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>1846. </p>

</div>
</div>
<a id="ac280285d39826f98f83043a75f01d44e" name="ac280285d39826f98f83043a75f01d44e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac280285d39826f98f83043a75f01d44e">&#9670;&#160;</a></span>cv_air</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a> fv_mapz_mod::cv_air = cp_air - rdgas</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>= rdgas * (7/2-1) = 2.5*rdgas=717.68 </p>

</div>
</div>
<a id="a4c1b41c250d4fae86c8297ebe5f71577" name="a4c1b41c250d4fae86c8297ebe5f71577"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c1b41c250d4fae86c8297ebe5f71577">&#9670;&#160;</a></span>cv_vap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a> fv_mapz_mod::cv_vap = 3.*rvgas</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>1384.5 </p>

</div>
</div>
<a id="a5f144b640540ec10df24f75e367c2057" name="a5f144b640540ec10df24f75e367c2057"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f144b640540ec10df24f75e367c2057">&#9670;&#160;</a></span>e_flux</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=4), public fv_mapz_mod::e_flux = 0.</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abb8dc5fd25041ba11e452a3994360336" name="abb8dc5fd25041ba11e452a3994360336"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb8dc5fd25041ba11e452a3994360336">&#9670;&#160;</a></span>r12</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a> fv_mapz_mod::r12 = 1./12.</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a24b67f915ffc43180f28b980d9ca7d4c" name="a24b67f915ffc43180f28b980d9ca7d4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24b67f915ffc43180f28b980d9ca7d4c">&#9670;&#160;</a></span>r23</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a> fv_mapz_mod::r23 = 2./3.</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a85ad5e9000a3d762fd9a62ce59fa9213" name="a85ad5e9000a3d762fd9a62ce59fa9213"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85ad5e9000a3d762fd9a62ce59fa9213">&#9670;&#160;</a></span>r3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a> fv_mapz_mod::r3 = 1./3.</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7cf7f37723bbfb2e7d6b4d948ea81567" name="a7cf7f37723bbfb2e7d6b4d948ea81567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cf7f37723bbfb2e7d6b4d948ea81567">&#9670;&#160;</a></span>t_min</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a> fv_mapz_mod::t_min = 184.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>below which applies stricter constraint </p>

</div>
</div>
<a id="a79c88aa388441e010f8532f6802b3240" name="a79c88aa388441e010f8532f6802b3240"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79c88aa388441e010f8532f6802b3240">&#9670;&#160;</a></span>tice</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, <a class="el" href="../../d3/d2b/mpif_8h.html#a6ac3ddb70a66589a330efa9f6d41bdbb">parameter</a> fv_mapz_mod::tice = 273.16</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
